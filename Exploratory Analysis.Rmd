---
title: "Exploratory Analysis"
author: "Richard G. Gardiner"
date: "2/21/2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Data and Packages

```{r}
library(tidyverse)
library(tidytext)
library(readxl)
```

```{r}
gavel <- read_excel("Gavel to Gavel dataset.xlsx")

str(gavel)
```

## Unnesting the tokens
```{r}
tidy_text <- gavel %>%
  unnest_tokens(word, Description) %>%
  anti_join(stop_words)
```

```{r}
tidy_text %>%
  count(word, sort = TRUE)
```

```{r}
tidy_text %>%
  group_by(curbing, Type) %>%
  count(word, sort = TRUE) %>%
  filter(n > 75) %>%
  filter(curbing == 1) %>%
  mutate(word = reorder(word, n)) %>%
  ggplot(aes(word, n, fill = Type)) +
  geom_col() +
  xlab(NULL) +
  facet_wrap(~ Type, scales = "free_y") +
  coord_flip()
```

```{r}
sentiments_gavel <- tidy_text %>%
  inner_join(get_sentiments("bing"))

sentiments_gavel %>%
  count(word, sentiment, sort = TRUE)
```


```{r}
sentiments_gavel_2 <- sentiments_gavel %>%
  count(sentiment, Year, Elected) %>%
  spread(sentiment, n, fill = 0) %>%
  mutate(net_sentiment = positive - negative)


ggplot(sentiments_gavel_2, aes(x = Year, y = net_sentiment, fill = net_sentiment > 0)) +
  geom_col() +
  facet_wrap(~Elected)
```

